/*!
 * Gameolith Widget Collection
 * Â© 736 Computing Services Ltd 2012
 * Apache 2.0 licence - http://opensource.736cs.com/licenses/apache2
 * Uses TinyBox2 (CC-BY) - http://www.scriptiny.com/2011/03/javascript-modal-windows/
 */
window.Gameolith={};Gameolith.tools={};Gameolith.loaded=false;Gameolith.tools.cssloader=function(a){var g=document,b=g.createElement("link"),c=g.getElementsByTagName("head")[0];b.rel="stylesheet";b.type="text/css";b.media="all";b.href=a;c.appendChild(b)};Gameolith.tools.box=function(){var e,c,a,f,d,h=0;return{show:function(g){d={opacity:70,close:1,animate:1,fixed:1,mask:1,maskid:"",boxid:"",topsplit:2,url:0,post:0,height:0,width:0,html:0,iframe:0};for(var b in g){d[b]=g[b]}if(!h){e=document.createElement("div");e.className="gme-tbox";h=document.createElement("div");h.className="gme-tinner";a=document.createElement("div");a.className="gme-tcontent";c=document.createElement("div");c.className="gme-tmask";f=document.createElement("div");f.className="gme-tclose";f.v=0;document.body.appendChild(c);document.body.appendChild(e);e.appendChild(h);h.appendChild(a);c.onclick=f.onclick=Gameolith.tools.box.hide;window.onresize=Gameolith.tools.box.resize}else{e.style.display="none";clearTimeout(h.ah);if(f.v){h.removeChild(f);f.v=0}}h.id=d.boxid;c.id=d.maskid;e.style.position=d.fixed?"fixed":"absolute";if(d.html&&!d.animate){h.style.backgroundImage="none";a.innerHTML=d.html;a.style.display="";h.style.width=d.width?d.width+"px":"auto";h.style.height=d.height?d.height+"px":"auto"}else{a.style.display="none";if(!d.animate&&d.width&&d.height){h.style.width=d.width+"px";h.style.height=d.height+"px"}else{h.style.width=h.style.height="100px"}}if(d.mask){this.mask();this.alpha(c,1,d.opacity)}else{this.alpha(e,1,100)}if(d.autohide){h.ah=setTimeout(Gameolith.tools.box.hide,1000*d.autohide)}else{document.onkeyup=Gameolith.tools.box.esc}},fill:function(p,m,l,j,g,o){if(m){if(d.image){var n=new Image();n.onload=function(){g=g||n.width;o=o||n.height;Gameolith.tools.box.psh(n,j,g,o)};n.src=d.image}else{if(d.iframe){this.psh('<iframe src="'+d.iframe+'" width="'+d.width+'" frameborder="0" height="'+d.height+'"></iframe>',j,g,o)}else{var b=window.XMLHttpRequest?new XMLHttpRequest():new ActiveXObject("Microsoft.XMLHTTP");b.onreadystatechange=function(){if(b.readyState===4&&b.status===200){h.style.backgroundImage="";Gameolith.tools.box.psh(b.responseText,j,g,o)}};if(l){b.open("POST",p,true);b.setRequestHeader("Content-type","application/x-www-form-urlencoded");b.send(l)}else{b.open("GET",p,true);b.send(null)}}}}else{this.psh(p,j,g,o)}},psh:function(l,i,g,j){if(typeof l==="object"){a.appendChild(l)}else{a.innerHTML=l}var b=h.style.width,k=h.style.height;if(!g||!j){h.style.width=g?g+"px":"";h.style.height=j?j+"px":"";a.style.display="";if(!j){j=parseInt(a.offsetHeight,10)}if(!g){g=parseInt(a.offsetWidth,10)}a.style.display="none"}h.style.width=b;h.style.height=k;this.size(g,j,i)},esc:function(b){b=b||window.event;if(b.keyCode===27){Gameolith.tools.box.hide()}},hide:function(){Gameolith.tools.box.alpha(e,-1,0,3);document.onkeypress=null;if(d.closejs){d.closejs()}},resize:function(){Gameolith.tools.box.pos();Gameolith.tools.box.mask()},mask:function(){c.style.height=this.total(1)+"px";c.style.width=this.total(0)+"px"},pos:function(){var b;if(typeof d.top!=="undefined"){b=d.top}else{b=(this.height()/d.topsplit)-(e.offsetHeight/2);b=b<20?20:b}if(!d.fixed&&!d.top){b+=this.top()}e.style.top=b+"px";e.style.left=typeof d.left!=="undefined"?d.left+"px":(this.width()/2)-(e.offsetWidth/2)+"px"},alpha:function(g,i,b){clearInterval(g.ai);if(i){g.style.opacity=0;g.style.filter="alpha(opacity=0)";g.style.display="block";Gameolith.tools.box.pos()}g.ai=setInterval(function(){Gameolith.tools.box.ta(g,b,i)},20)},ta:function(g,b,j){var i=Math.round(g.style.opacity*100);if(i===b){clearInterval(g.ai);if(j===-1){g.style.display="none";g===e?Gameolith.tools.box.alpha(c,-1,0,2):a.innerHTML=h.style.backgroundImage=""}else{if(g===c){this.alpha(e,1,100)}else{e.style.filter="";Gameolith.tools.box.fill(d.html||d.url,d.url||d.iframe||d.image,d.post,d.animate,d.width,d.height)}}}else{var k=b-Math.floor(Math.abs(b-i)*0.5)*j;g.style.opacity=k/100;g.style.filter="alpha(opacity="+k+")"}},size:function(g,j,b){if(b){clearInterval(h.si);var i=parseInt(h.style.width,10)>g?-1:1,k=parseInt(h.style.height,10)>j?-1:1;h.si=setInterval(function(){Gameolith.tools.box.ts(g,i,j,k)},20)}else{h.style.backgroundImage="none";if(d.close){h.appendChild(f);f.v=1}h.style.width=g+"px";h.style.height=j+"px";a.style.display="";this.pos();if(d.openjs){d.openjs()}}},ts:function(g,k,j,l){var b=parseInt(h.style.width,10),i=parseInt(h.style.height,10);if(b===g&&i===j){clearInterval(h.si);h.style.backgroundImage="none";a.style.display="block";if(d.close){h.appendChild(f);f.v=1}if(d.openjs){d.openjs()}}else{if(b!==g){h.style.width=(g-Math.floor(Math.abs(g-b)*0.6)*k)+"px"}if(i!==j){h.style.height=(j-Math.floor(Math.abs(j-i)*0.6)*l)+"px"}this.pos()}},top:function(){return document.documentElement.scrollTop||document.body.scrollTop},width:function(){return self.innerWidth||document.documentElement.clientWidth||document.body.clientWidth},height:function(){return self.innerHeight||document.documentElement.clientHeight||document.body.clientHeight},total:function(j){var g=document.body,i=document.documentElement;return j?Math.max(Math.max(g.scrollHeight,i.scrollHeight),Math.max(g.clientHeight,i.clientHeight)):Math.max(Math.max(g.scrollWidth,i.scrollWidth),Math.max(g.clientWidth,i.clientWidth))}}}();Gameolith.tools.link=function(f){var e,d,g;if(/^https/.test(location)){e="https"}else{e="http"}d="://www.gameolith.com/";if(f.charAt(0)==="/"){g=f.slice(1)}else{g=f}return e+d+g};Gameolith.tools.strip=function(a){var b;b=document.createElement("div");b.innerHTML=a;return b.textContent||b.innerText};Gameolith.tools.createBox=function(c,a){var b,d;b=document.createElement("iframe");d=Gameolith.tools.link("/try/"+(escape(a))+"/?type=widget&utm_source=widgets&utm_medium=demo_box");b.setAttribute("frameborder",0);b.setAttribute("style","overflow:hidden");b.setAttribute("scrolling","no");b.setAttribute("width",500);b.setAttribute("height",215);b.setAttribute("name","__gameolith_box_"+c);b.setAttribute("id","__gameolith_box_"+c);b.setAttribute("sandbox","allow-same-origin allow-scripts");b.setAttribute("seamless","seamless");b.setAttribute("src",d);return b};Gameolith.tools.createButton=function(c,a,e){var b,d;b=document.createElement("iframe");if(e==="undefined"){e=""}d=Gameolith.tools.link("/try/"+(escape(a))+"/?type=button&utm_source=widgets&utm_medium=demo_button&button="+c+"&text="+(Gameolith.tools.strip(e)));b.setAttribute("frameborder",0);b.setAttribute("style","overflow:hidden");b.setAttribute("scrolling","no");b.setAttribute("height",28);b.setAttribute("style","width:1px");b.setAttribute("name","__gameolith_button_"+c);b.setAttribute("id","__gameolith_button_"+c);b.setAttribute("src",d);b.style.visibility="hidden";return b};Gameolith.messageRead=function(b){var a,c;c=b.data.split("=");a={};a.id=c[0].replace("#","");a.request=c[1];a.dom_object=document.getElementById("__gameolith_button_"+a.id);a.replaced_object=document.querySelector("[data-gameolith-object-id='__gameolith_button_"+a.id+"']");a.slug=a.replaced_object.getAttribute("data-game");if(Gameolith.debug){console.log(b.data)}if(a.request==="overlay"){return Gameolith.tools.box.show({iframe:Gameolith.tools.link("/try/"+a.slug+"/?type=widget&utm_source=widgets&utm_medium=demo_overlay"),width:500,height:215})}else{a.width=parseInt(a.request,10)+10;a.dom_object.style.visibility="visible";return a.dom_object.style.width=""+a.width+"px"}};Gameolith.init=function(){var d,h,f,k,a,e,g,c,j,i,b;a=document.querySelectorAll(".gameolith-demo[data-widget='box']");e=document.querySelectorAll(".gameolith-demo[data-widget='button']");for(g=0,i=a.length;g<i;g++){d=a[g];c=d.getAttribute("data-game");h=Gameolith.tools.createBox(g,c);d.parentNode.insertBefore(h,d);d.setAttribute("data-gameolith-object-id","__gameolith_box_"+g);d.style.display="none"}for(g=0,b=e.length;g<b;g++){f=e[g];j=f.innerHTML;c=f.getAttribute("data-game");k=Gameolith.tools.createButton(g,c,j);f.parentNode.insertBefore(k,f);f.setAttribute("data-gameolith-object-id","__gameolith_button_"+g);f.style.display="none"}if(window._gmecssoverride===void 0){Gameolith.tools.cssloader("https://widgets.gameolith.com/css/platform/style.min.css")}else{Gameolith.tools.cssloader(window._gmecssoverride)}window.addEventListener("message",Gameolith.messageRead,false);return a.length+e.length};if(document.readyState==="complete"){Gameolith.init()}if(window.addEventListener){window.addEventListener("load",Gameolith.init,false)}else{if(document.attachEvent){window.attachEvent("load",Gameolith.init)}else{window.onload=Gameolith.init}};